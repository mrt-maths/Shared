<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MRT Maths Games</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:32px;background:#f5f7fb}
  h1{margin:0 0 10px}
  p{margin:0 0 18px;opacity:.75}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
  a.card{display:block;text-decoration:none;color:#111;background:#fff;border:1px solid #ddd;border-radius:14px;padding:16px;transition:.15s}
  a.card:hover{transform:translateY(-3px);box-shadow:0 10px 18px rgba(0,0,0,.08)}
  .title{font-weight:700;font-size:18px;margin-bottom:6px}
  .desc{font-size:13px;opacity:.75;line-height:1.3;word-break:break-word}
  .error{background:#fff3f3;border:1px solid #ffd0d0;border-radius:12px;padding:12px}
  .toolbar{display:flex;gap:10px;align-items:center;margin:14px 0 18px;flex-wrap:wrap}
  input{padding:10px 12px;border:1px solid #ddd;border-radius:10px;min-width:260px}
  button{padding:10px 12px;border:1px solid #ddd;border-radius:10px;background:#fff;cursor:pointer}
  button:hover{box-shadow:0 6px 14px rgba(0,0,0,.06)}
  .small{font-size:12px;opacity:.7}
</style>
</head>
<body>
  <h1>MRT Maths Games</h1>
  <p>Auto-generated list of HTML games in this folder.</p>

  <div class="toolbar">
    <input id="q" type="search" placeholder="Search games..." aria-label="Search games">
    <button id="reload" type="button">Reload</button>
    <span class="small" id="meta"></span>
  </div>

  <div id="status"></div>
  <div class="grid" id="games"></div>

<script>
/* Site: https://mrt-maths.github.io/Shared/ */
const OWNER  = "mrt-maths";
const REPO   = "Shared";
const BRANCH = "main";
/* If your games are in a subfolder (e.g. /games), set PATH="games" */
const PATH   = "";

const statusEl = document.getElementById("status");
const gridEl = document.getElementById("games");
const qEl = document.getElementById("q");
const metaEl = document.getElementById("meta");

let allFiles = [];

function prettify(filename){
  return filename
    .replace(/\.html$/i,"")
    .replace(/[-_]+/g," ")
    .replace(/\b\w/g, c => c.toUpperCase());
}

function render(list){
  if (!list.length){
    gridEl.innerHTML = "";
    statusEl.innerHTML = `<div class="error">No matching HTML files found.</div>`;
    metaEl.textContent = "";
    return;
  }
  statusEl.innerHTML = "";
  const base = PATH ? (PATH.replace(/\/+$/,"") + "/") : "";
  gridEl.innerHTML = list.map(f => `
    <a class="card" href="${base}${encodeURI(f)}">
      <div class="title">${prettify(f)}</div>
      <div class="desc">${base}${f}</div>
    </a>
  `).join("");
  metaEl.textContent = `${list.length} game(s)`;
}

async function load(){
  statusEl.innerHTML = `<div class="small">Loading…</div>`;
  gridEl.innerHTML = "";
  metaEl.textContent = "";

  try{
    const api = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${PATH}?ref=${encodeURIComponent(BRANCH)}`;
    const res = await fetch(api, { headers: { "Accept": "application/vnd.github+json" }});
    if(!res.ok){
      throw new Error(`GitHub API error ${res.status}. Check OWNER/REPO/BRANCH/PATH and that the repo is public.`);
    }
    const items = await res.json();

    allFiles = items
      .filter(x => x.type === "file" && /\.html$/i.test(x.name))
      .map(x => x.name)
      .filter(n => n.toLowerCase() !== "index.html")
      .sort((a,b) => a.localeCompare(b));

    if(!allFiles.length){
      statusEl.innerHTML = `<div class="error">No other .html files found in this folder. If they’re in a subfolder, set PATH to that folder name.</div>`;
      return;
    }

    render(allFiles);
  } catch(err){
    statusEl.innerHTML = `<div class="error"><b>Couldn’t load game list.</b><br>${err.message}</div>`;
  }
}

qEl.addEventListener("input", () => {
  const term = qEl.value.trim().toLowerCase();
  const filtered = allFiles.filter(f => f.toLowerCase().includes(term));
  render(filtered);
});

document.getElementById("reload").addEventListener("click", load);

load();
</script>
</body>
</html>
